<div class="graph row" id="graphSpace">
    <div ng-include src="'/static/partials/navigationBar.html'"></div>

    <svg xmlns="http://www.w3.org/2000/svg" height="0" width="0" style="margin: 0; padding:0">
        <!--
            Definitions for the graph arrowheads here in a separate svg.
            This is necessary for correct display in Chrome.
        -->
        <defs>
            <marker id="arrowHead" orient="auto" markerHeight="5"
                    markerWidth="5" refX="5" viewBox="0 -5 10 10"
                    class="linkHead">
                <path d="M0,-5L10,0L0,5"></path>
            </marker>
            <filter id="blur">
                <feGaussianBlur stdDeviation="2"></feGaussianBlur>
            </filter>
        </defs>
    </svg>

    <div style="position: relative; left: -50%; float: right; overflow: visible; margin-bottom: 1em;">
        <div style="position: relative; left: 50%;">
            <div class="tipp">

                <span ng-if="graphData.length > 1">Es gibt zu diesem Thema {{ graphData.length }} konkurrierende
                    <a href="http://www.findeco.de/hilfe/vorschlage/" class="tippLink">Vorschläge</a>.</span>
                <form>
                    Es werden
                    <select name="graph-filter" size="1" style="font-size: 100%; color: gray;"
                                      ng-model="graphType" ng-change="updateGraph()">
                        <option value="default" disabled>nur relevante</option>
                        <option value="full" selected>alle außer Spam</option>
                        <option value="withSpam">alle</option>
                    </select>
                    Vorschläge angezeigt:
                </form>
            </div>
        </div>
    </div>
    <div style="position: relative; left: -50%; float: right; overflow: visible; margin-bottom: 1em;">
        <div style="position: relative; left: 50%;">
            <div findeco-graph data="graphData" path="nav.nodePath" height="180" width="graphWidth" class="graph"></div>
        </div>
    </div>
</div>
<div class="clearer"></div>
<div class="toggle row">
    <div class="padded left" style="width: calc(50% - 2em);" ng-click="showArguments = !showArguments">
        <a href="" class="left">
            <span ng-if="!showArguments">Argumente zeigen</span>
            <span ng-if="showArguments">Argumente verbergen</span>
        </a>
    </div>
    <div class="padded right" style="width: calc(50% - 2em);" ng-click="showMicroblogging = !showMicroblogging">
        <a href="" class="right">
            <span ng-if="!showMicroblogging">Microblogging zeigen</span>
            <span ng-if="showMicroblogging">Microblogging verbergen</span>
        </a>
    </div>
</div>
<div class="clearer"></div>
<div class="content row" style="overflow: visible;">
    <div ng-style="{'left': argumentsPosition + 'em', 'position': 'absolute'}"
         class="smallColumn left animateArguments" style="position: relative;">
        <div ng-include src="'/static/partials/argument.html'" style="position: relative;"></div>
    </div>
    <div style="position: absolute; overflow-x: hidden; padding: 0; margin: 0;"
         ng-style="{'right': microbloggingPosition + 'em', 'width': 'calc(22em + ' + microbloggingPosition + 'em'}">
        <div ng-style="{'right': microbloggingPosition + 'em'}"
             class="smallColumn right" style="position: relative;">
            <div ng-include src="'/static/partials/microblogging.html'"></div>
        </div>
    </div>

    <div class="textColumn left contentText">
        <div ng-if="!user.isLoggedIn&&fesettings.disclaimer.enable"
             ng-bind-html-unsafe="fesettings.disclaimer.text"
             class="disclaimer box">
        </div>

        <div class="authors">
            Autoren des Vorschlags: <div ng-repeat="author in authors"><a ng-href="/user/{{ author }}">{{ author }}</a> </div>
        </div>
        <div spam-mark show-if="user.isLoggedIn" entity="nodeInfo" mark-func="markNode"></div>
        <div follow-star show-if="user.isLoggedIn" entity="nodeInfo" mark-func="markMainNode" width="21" height="21"></div>
        <h1 >{{ nodeInfo.fullTitle }}</h1>

        <p creole wiki-text="nodeInfo.wikiText"></p>

        <div ng-show="sections.length > 0" class="tipp">
            Dieser <a href="http://www.findeco.de/hilfe/vorschlage/" class="tippLink">Vorschlag</a>
            hat {{ nodeInfo.indexList.length }} Abschnitte.
            Du kannst hier alle Abschnitte <a ng-hide="allExpanded" ng-click="expandAll()" style="cursor: pointer;">ausklappen</a>
            <a ng-show="allExpanded" ng-click="collapseAll()" style="cursor: pointer;">einklappen</a>.
        </div>
        <div ng-repeat="section in nodeInfo.indexList">

            <a ng-show="!section.isExpanded" ng-hide="nav.type=='root'" ng-click="expandSection(section)"
               style="float:left;position: relative; top: 8px; margin-right: 5px;"
               title="{{'_expandSection_'|i18n}}">
                <img src="/static/images/expand.png"
                     onmouseover="this.src='/static/images/expand_hover.png';"
                     onmouseout="this.src='/static/images/expand.png';">
            </a>
            <a ng-show="section.isExpanded" ng-click="collapseSection(section)"
               style="float:left;position: relative; top: 8px; margin-right: 5px;"
               title="{{'_collapseSection_'|i18n}}">
                <img src="/static/images/collapse.png"
                     onmouseover="this.src='/static/images/collapse_hover.png';"
                     onmouseout="this.src='/static/images/collapse.png';">
            </a>

            <h2 ng-show="!section.isExpanded">
                <a href="/{{ nav.getPathForNode(section.shortTitle,  section.index) }}">{{section.fullTitle}}</a>
            </h2>

            <div class="sectionText" ng-show="section.isExpanded" ng-repeat="paragraph in section.paragraphs">
                <div spam-mark show-if="user.isLoggedIn" entity="paragraph" mark-func="markNode"></div>
                <div follow-star show-if="user.isLoggedIn" entity="paragraph" mark-func="markNode" width="21" height="21"></div>
                <div creole wiki-text="paragraph.wikiText"></div>
            </div>
        </div>
        <div class="btnBar">
            <div ng-show="user.isLoggedIn " class="btn btn-primary" ng-click="relocate('create/topic')"
                 data-i18n="_createNewText_"></div>

            <div ng-show="user.isLoggedIn" class="btn btn-primary" ng-click="relocate('create/derivate')"
                 data-i18n="_createDerivativeText_"></div>

            <div ng-show="user.isLoggedIn" class="btn btn-primary" ng-click="relocate('create/opposing')"
                 data-i18n="_createOpposingText_"></div>

            <div ng-show="nodeInfo.derivate != undefined && nodeInfo.derivate != '' " class="btn btn-primary"
                 ng-click="relocateToDerivate()" data-i18n="_goToDerivateNode_"></div>
        </div>

        <div ng-show="isLoading()" class="deactivateDiv">
        </div>
        <div ng-show="isLoading()" class="deactivateSpinner">
        </div>

        <div style="clear:both; padding-bottom:25px;"></div>
        <div ng-if="user.isLoggedIn&&fesettings.disclaimer.enable"
             ng-bind-html-unsafe="fesettings.disclaimer.text"
             class="disclaimer box" >
        </div>

        <div ng-include src="'/static/partials/messagebox.html'"></div>
    </div>
</div>
<div class="clearer"></div>